import{X as S,r as g,Y as E,Z as h,c as I,E as L,$ as v,a0 as G,a1 as x,a2 as B,a3 as A,S as Y,C as j,a4 as C,a5 as _,a6 as b}from"./entry.3f2982f6.js";const k=(a,o,s)=>!a||!a[o.id]?[]:a[o.id].filter(r=>s.prodotti.map(e=>e.id).includes(r.id)),U=(a,o)=>{let s=0;s=a.map(e=>{var t;return((t=e.data)==null?void 0:t.price)??0}).reduce((e,t)=>(e??0)+(t??0),0)??0;let r=a.filter(e=>!e.data.isGift).length-(o.limitPrice??0);return o.limitPrice&&r>0&&(s+=r*(o.extraPrice??0)),s},Q=(a,o,s)=>{let r=0;return o.forEach(e=>{var t=k(a,e,s);r+=U(t,e)}),r},$={type:"square",color:"#33b663",gradient:{type:"radial",rotation:0,colorStops:[{offset:0,color:"#33b663"},{offset:1,color:"#1e8b49"}]}},z={type:"square",color:"#1e8b49",gradient:null},H={type:"square",gradient:{type:"radial",rotation:0,colorStops:[{offset:0,color:"#69ca8c"},{offset:1,color:"#21914c"}]}},P="Categories",J=()=>{const a=S(),o=w(),s=g(0),{getMenuItemsFromCategory:r}=D(),e=g(),t=E(a,P),m=h(t),u=I(async()=>{var l=m.value.map(async O=>{const R=await r(g(O).value);return{[g(O).value.id]:R}}),i={};return(await Promise.all(l)).forEach(O=>{i={...i,...O}}),i});return u.value.then(l=>{e.value=l}),L(o,()=>{s.value=Q(e.value,m.value,o.value),u.value.then(l=>{e.value=l})},{deep:!0}),{categoriesCollection:m,menuItemsWithCategories:u,orderTotal:s,menuItems:e}},y="MenuItems",D=()=>{const a=S(),o=E(a,y);return{serverMenuItemsCollection:h(o).value.map(t=>({ref:t.id,data:t})),getMenuItemsFromCategory:async t=>{const m=v(a,P,t.id),u=await G(x(E(a,y),B("category","==",m)));let l=[];return u.forEach(i=>{l.push({id:i.id,data:i.data()})}),l}}},T=(a,o,s={})=>{const r={prodotti:{...s.prodotti}};return r.prodotti[o.nome]=o.prodotti.map(e=>v(a,y,e.id)),r},V={nome:"",prodotti:[]},W={prodotti:{}},p="Orders",w=()=>A("order",()=>structuredClone(V)),X=()=>A("globalOrder",()=>structuredClone(W)),K=()=>{const{serverMenuItemsCollection:a}=D(),o=w(),s=Y(),r=X(),e=j(),t=S(),m=E(t,p),u=h(m),l=()=>{const n=u.value.length+"",d=T(t,o.value),c=v(t,p,n);C(c,d),r.value=_(c),e.value=n},i=async()=>{const n=v(t,p,e.value),d=(await b(n)).data(),c=T(t,o.value,d);C(v(t,p,e.value),c)},O=async n=>{const d=v(t,p,e.value),c=(await b(d)).data(),f=T(t,o.value,c);delete f.prodotti[n],C(v(t,p,e.value),f)},R=()=>{const n=v(t,p,e.value);r.value=_(n)},M=n=>{var d;return(d=a.find(c=>c.ref==n.id))==null?void 0:d.data},N=n=>{var c;var d=(c=r.value)==null?void 0:c.prodotti[n].map(f=>({id:f.id,data:M(f)}));o.value={nome:n,prodotti:d},s.value=!1},F=I(()=>Object.keys(r.value?r.value.prodotti:{})),q=I(()=>r.value?Object.keys(r.value.prodotti).length==0:!0);return{ordersCollection:u,updateOrder:i,createOrder:l,getGlobalOrder:R,deleteOrder:O,getItemFromId:M,selectOrder:N,isEmptyOrder:q,users:F}};export{z as C,$ as D,W as E,K as a,w as b,U as c,J as d,Q as e,H as f,k as g,V as h,X as u};
