import{X as S,r as g,Y as E,Z as M,c as I,E as L,$ as i,a0 as G,a1 as x,a2 as B,a3 as A,S as Y,C as j,a4 as C,a5 as _,a6 as b}from"./entry.ae8891c9.js";const k=(s,o,a)=>!s||!s[o.id]?[]:s[o.id].filter(r=>a.prodotti.map(e=>e.id).includes(r.id)),U=(s,o)=>{let a=0;a=s.map(e=>{var t;return((t=e.data)==null?void 0:t.price)??0}).reduce((e,t)=>(e??0)+(t??0),0)??0;let r=s.filter(e=>!e.data.isGift).length-(o.limitPrice??0);return o.limitPrice&&r>0&&(a+=r*(o.extraPrice??0)),a},Q=(s,o,a)=>{let r=0;return o.forEach(e=>{var t=k(s,e,a);r+=U(t,e)}),r},$={type:"square",color:"#33b663",gradient:{type:"radial",rotation:0,colorStops:[{offset:0,color:"#33b663"},{offset:1,color:"#1e8b49"}]}},z={type:"square",color:"#1e8b49",gradient:null},H={type:"square",gradient:{type:"radial",rotation:0,colorStops:[{offset:0,color:"#69ca8c"},{offset:1,color:"#21914c"}]}},P="Categories",J=()=>{const s=S(),o=w(),a=g(0),{getMenuItemsFromCategory:r}=D(),e=g(),t=E(s,P),v=M(t),m=I(async()=>{var d=v.value.map(async O=>{const R=await r(g(O).value);return{[g(O).value.id]:R}}),u={};return(await Promise.all(d)).forEach(O=>{u={...u,...O}}),u});return m.value.then(d=>{e.value=d}),L(o,()=>{a.value=Q(e.value,v.value,o.value)},{deep:!0}),{categoriesCollection:v,menuItemsWithCategories:m,orderTotal:a,menuItems:e}},y="MenuItems",D=()=>{const s=S(),o=E(s,y);return{serverMenuItemsCollection:M(o).value.map(t=>({ref:t.id,data:t})),getMenuItemsFromCategory:async t=>{const v=i(s,P,t.id),m=await G(x(E(s,y),B("category","==",v)));let d=[];return m.forEach(u=>{d.push({id:u.id,data:u.data()})}),d}}},T=(s,o,a={})=>{const r={prodotti:{...a.prodotti}};return r.prodotti[o.nome]=o.prodotti.map(e=>i(s,y,e.id)),r},V={nome:"",prodotti:[]},W={prodotti:{}},p="Orders",w=()=>A("order",()=>structuredClone(V)),X=()=>A("globalOrder",()=>structuredClone(W)),K=()=>{const{serverMenuItemsCollection:s}=D(),o=w(),a=Y(),r=X(),e=j(),t=S(),v=E(t,p),m=M(v),d=()=>{const n=m.value.length+"",l=T(t,o.value),c=i(t,p,n);C(c,l),r.value=_(c),e.value=n},u=async()=>{const n=i(t,p,e.value),l=(await b(n)).data(),c=T(t,o.value,l);C(i(t,p,e.value),c)},O=async n=>{const l=i(t,p,e.value),c=(await b(l)).data(),f=T(t,o.value,c);delete f.prodotti[n],C(i(t,p,e.value),f)},R=()=>{const n=i(t,p,e.value);r.value=_(n)},h=n=>{var l;return(l=s.find(c=>c.ref==n.id))==null?void 0:l.data},N=n=>{var c;var l=(c=r.value)==null?void 0:c.prodotti[n].map(f=>({id:f.id,data:h(f)}));o.value={nome:n,prodotti:l},a.value=!1},F=I(()=>Object.keys(r.value?r.value.prodotti:{})),q=I(()=>r.value?Object.keys(r.value.prodotti).length==0:!0);return{ordersCollection:m,updateOrder:u,createOrder:d,getGlobalOrder:R,deleteOrder:O,getItemFromId:h,selectOrder:N,isEmptyOrder:q,users:F}};export{z as C,$ as D,W as E,K as a,w as b,U as c,J as d,Q as e,H as f,k as g,V as h,X as u};
