import{X as S,r as g,Y as E,Z as M,c as I,E as L,$ as i,a0 as G,a1 as x,a2 as B,a3 as A,S as Y,C as j,a4 as C,a5 as _,a6 as b}from"./entry.d2759c42.js";const k=(s,r,a)=>s?s[r.id].filter(o=>a.prodotti.map(e=>e.id).includes(o.id)):[],U=(s,r)=>{let a=0;a=s.map(e=>{var t;return((t=e.data)==null?void 0:t.price)??0}).reduce((e,t)=>(e??0)+(t??0),0)??0;let o=s.filter(e=>!e.data.isGift).length-(r.limitPrice??0);return r.limitPrice&&o>0&&(a+=o*(r.extraPrice??0)),a},Q=(s,r,a)=>{let o=0;return r.forEach(e=>{var t=k(s,e,a);o+=U(t,e)}),o},$={type:"square",color:"#33b663",gradient:{type:"radial",rotation:0,colorStops:[{offset:0,color:"#33b663"},{offset:1,color:"#1e8b49"}]}},z={type:"square",color:"#1e8b49",gradient:null},H={type:"square",gradient:{type:"radial",rotation:0,colorStops:[{offset:0,color:"#69ca8c"},{offset:1,color:"#21914c"}]}},P="Categories",J=()=>{const s=S(),r=w(),a=g(0),{getMenuItemsFromCategory:o}=D(),e=g(),t=E(s,P),m=M(t),v=I(async()=>{var d=m.value.map(async O=>{const R=await o(g(O).value);return{[g(O).value.id]:R}}),u={};return(await Promise.all(d)).forEach(O=>{u={...u,...O}}),u});return v.value.then(d=>{e.value=d}),L(r,()=>{a.value=Q(e.value,m.value,r.value)},{deep:!0}),{categoriesCollection:m,menuItemsWithCategories:v,orderTotal:a,menuItems:e}},y="MenuItems",D=()=>{const s=S(),r=E(s,y);return{serverMenuItemsCollection:M(r).value.map(t=>({ref:t.id,data:t})),getMenuItemsFromCategory:async t=>{const m=i(s,P,t.id),v=await G(x(E(s,y),B("category","==",m)));let d=[];return v.forEach(u=>{d.push({id:u.id,data:u.data()})}),d}}},T=(s,r,a={})=>{const o={prodotti:{...a.prodotti}};return o.prodotti[r.nome]=r.prodotti.map(e=>i(s,y,e.id)),o},V={nome:"",prodotti:[]},W={prodotti:{}},p="Orders",w=()=>A("order",()=>structuredClone(V)),X=()=>A("globalOrder",()=>structuredClone(W)),K=()=>{const{serverMenuItemsCollection:s}=D(),r=w(),a=Y(),o=X(),e=j(),t=S(),m=E(t,p),v=M(m),d=()=>{const n=v.value.length+"",l=T(t,r.value),c=i(t,p,n);C(c,l),o.value=_(c),e.value=n},u=async()=>{const n=i(t,p,e.value),l=(await b(n)).data(),c=T(t,r.value,l);C(i(t,p,e.value),c)},O=async n=>{const l=i(t,p,e.value),c=(await b(l)).data(),f=T(t,r.value,c);delete f.prodotti[n],C(i(t,p,e.value),f)},R=()=>{const n=i(t,p,e.value);o.value=_(n)},h=n=>{var l;return(l=s.find(c=>c.ref==n.id))==null?void 0:l.data},N=n=>{var c;var l=(c=o.value)==null?void 0:c.prodotti[n].map(f=>({id:f.id,data:h(f)}));r.value={nome:n,prodotti:l},a.value=!1},F=I(()=>Object.keys(o.value?o.value.prodotti:{})),q=I(()=>o.value?Object.keys(o.value.prodotti).length==0:!0);return{ordersCollection:v,updateOrder:u,createOrder:d,getGlobalOrder:R,deleteOrder:O,getItemFromId:h,selectOrder:N,isEmptyOrder:q,users:F}};export{z as C,$ as D,W as E,K as a,w as b,U as c,J as d,Q as e,H as f,k as g,V as h,X as u};
